# LeadTrak: Buyer Lead Intake App

LeadTrak is a mini-app to capture, list, and manage buyer leads. It's built with modern web technologies, focusing on a clean user experience, robust validation, and efficient data management.

This project was generated by an AI engineer based on a detailed proposal.

## Features

- **Lead Management:** Full CRUD (Create, Read, Update, Delete) functionality for buyer leads.
- **Advanced Filtering & Search:** Server-side pagination, URL-synced filters, and an AI-powered debounced search.
- **Data Validation:** Robust validation using Zod on both client and server sides.
- **Concurrency Control:** Prevents data conflicts during edits with a timestamp-based check.
- **Audit History:** Tracks and displays the history of changes for each lead.
- **CSV Operations:** Import leads from a CSV with row-by-row validation and export the current filtered list.
- **Authentication:** A simple demo login system to simulate user sessions and ownership.
- **Responsive Design:** A professional, responsive layout with a collapsible sidebar and dark mode support.

## Tech Stack

- **Framework:** Next.js (App Router)
- **Language:** TypeScript
- **Styling:** Tailwind CSS with shadcn/ui components
- **Validation:** Zod
- **State Management:** React Hooks & Context API
- **AI:** Genkit for AI-powered search query processing

## Getting Started

### Prerequisites

- Node.js (v18 or later)
- npm, yarn, or pnpm

### Setup

1.  **Clone the repository:**
    ```bash
    git clone <repository-url>
    cd <repository-name>
    ```

2.  **Install dependencies:**
    ```bash
    npm install
    ```

3.  **Set up environment variables:**
    Create a `.env.local` file in the root of the project. For this project, no specific variables are required for the mock setup to run as the data is seeded in memory.

    ```
    # .env.local
    # Add any real API keys here if you extend the project
    ```

4.  **Run the development server:**
    ```bash
    npm run dev
    ```

The application will be available at `http://localhost:9002`.

## Design & Architecture Notes

### Validation

Validation is a core aspect of this application, handled primarily by **Zod**.

-   **Schema Definition:** Schemas for the `Buyer` model are defined in `src/lib/schema.ts`. These schemas serve as the single source of truth for data validation.
-   **Client-Side:** `react-hook-form` is used for managing forms, with `@hookform/resolvers/zod` to apply Zod schemas directly. This provides instant feedback to the user as they type.
-   **Server-Side:** The same Zod schemas are used within Server Actions (`src/lib/actions.ts`) to validate incoming data before it's processed. This ensures data integrity even if client-side validation is bypassed.

### SSR vs. Client Components

The application leverages the Next.js App Router to balance server-side rendering and client-side interactivity.

-   **Server Components:** Pages like `/buyers` are primarily Server Components. They handle data fetching based on URL search parameters (for filtering, sorting, and pagination), providing fast initial page loads and good SEO.
-   **Client Components:** Components requiring interactivity, such as filter dropdowns, search inputs (`buyers-client-page.tsx`), forms (`buyer-form.tsx`), and the main navigation (`app-layout.tsx`), are marked as Client Components (`'use client'`). They manage local state and user events. This hybrid approach optimizes performance by minimizing the amount of JavaScript sent to the client.

### Ownership & Authorization

Authorization is managed through a simple, mock authentication system (`src/lib/auth.tsx`).

-   A user's session (including their `id` and `role`) is stored in a React Context.
-   **UI Layer:** In the UI, buttons for editing or deleting are conditionally rendered or disabled based on whether the logged-in user's `id` matches the lead's `ownerId` or if the user has an `ADMIN` role. This is done in `src/components/buyers/buyer-form.tsx`.
-   **Server Action Layer:** The same ownership checks are performed within Server Actions (`updateLead`) to prevent unauthorized mutations at the backend level. This is the authoritative enforcement point, ensuring security even if the client-side UI is manipulated.

## What's Done vs. Skipped

### Done

-   All core "must-have" features from the proposal have been implemented.
-   CRUD operations, filtering, search, pagination, and URL state synchronization.
-   Client and server-side validation.
-   CSV import and export functionality.
-   A mock authentication and ownership system.
-   Concurrency control for edits.
-   History log for lead changes.
-   The UI is professionally designed, responsive, and includes a dark mode.

### Skipped & Rationale

-   **Real Database & Migrations:** The prompt specified a database like Postgres with migrations. As this is a frontend-focused demonstration running in a restricted environment, a real database connection was not feasible. Instead, data is mocked in `src/lib/data.ts` and seeded on application start. The data access functions (`getLeads`, `createLead`, etc.) are designed to mimic how one would interact with an ORM like Prisma or Drizzle, making it straightforward to swap in a real database.
-   **Unit Tests:** The project setup does not include a testing framework like Jest or Vitest. However, the code is structured to be testable. For example, validation logic is contained within Zod schemas, which can be tested in isolation.
-   **Rate Limiting:** Implementing rate limiting effectively requires a persistent store (like Redis) and server middleware, which is beyond the scope of this mock environment. This would typically be added at the infrastructure or API gateway level in a production application.# LeadTrak
